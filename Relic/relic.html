
<!-- Tabs -->
<div class="tab-buttons middle center">
  <button type="action" class="character" name="act_character" data-i18n="character" >Character</button>
  <button type="action" class="party" name="act_party" data-i18n="party" >Party</button>
  <button type="action" class="gamemaster" name="act_gamemaster" data-i18n="gamemaster-abbr" >GM</button>
  <button type="action" class="settings" name="act_settings" data-i18n="settings" >Settings</button>
</div>

<input type="hidden" class="tabstoggle" name="attr_sheetTab"  value="character">

<!--  ----------------------------------------------------------------------------------------------------------------------- -->
<!--  ------------------------------------------------- CHARACTER ----------------------------------------------------------- -->
<!--  ----------------------------------------------------------------------------------------------------------------------- -->

<main class="character">

  <!-- Playbook -->
  <!-- 
    Dropdown with Options and a custom option to be filled in the settings tab
    alternatively enter text and on pre-set names use the default abilities for the archetype
    Playbook will populate the data in archetype abilities with default text
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="playbook-name">Playbook Name</span>
    </div>
    <div class="heading-box2">
      <input class="input" type="text" name="attr_playbook_name" value="" title="@{playbook_name}" />
    </div>
  </div>

  <!-- Name and Origin -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="name-origin">Name & Origin</span>
    </div>
    <div class="heading-grid">
      <div class="heading-box2">
        <span class="label" data-i18n="i-am-called">I am called</span>
      </div>
      <div class="heading-box3">
        <input class="input" type="text" name="attr_character_name" value="" title="@{character_name}" />
      </div>
      <div class="heading-box4">
        <span class="label" data-i18n="name-of-suffix">of</span>
      </div>
      <div class="heading-box5">
        <input class="input" type="text" name="attr_character_name_suffix" value="" title="@{character_name_suffix}" />
      </div>
    </div>
  </div>

  <!-- Appearance & Background -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="appearance-background">Appearance & Background</span>
    </div>
    <div class="heading-grid">
      <div class="heading-box2">
        <span class="label" data-i18n="appearance">Appearance</span>
      </div>
      <div class="heading-box3">
        <input class="input" type="text" name="attr_char_appearance" value="" title="@{char_appearance}" />
      </div>
      <div class="heading-box4">
        <span class="label" data-i18n="background">Background</span>
      </div>
      <div class="heading-box5">
        <input class="input" type="text" name="attr_char_background" value="" title="@{char_background}" />
      </div>
    </div>
  </div>


  <!-- Arcs -->
  <!-- 
    Four options to choose from and each option has two text fields (For what text?)
    Playbook suggests but players might create own
    2 to 3 boxes for points of the selected arc
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="arcs">Arcs</span>
    </div>
  </div>

  <!-- Questions -->
  <!-- 
    Four questions players can ask their neighbors (Will any text entry result from this?)
    Playbook autopopulates. Custom ones also encouraged
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="questions">Questions</span>
    </div>
  </div>

  <!-- Companions -->
  <!-- 
    Three boxes for companion names and checkboxes
    Track other PCs and if one can use their "strings" to influence them (flexible number of lines (3+))
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="companions">Companions:</span>
      <fieldset class="repeating_companion">
        <input type="text" name="attr_companion_name" value="">
        <input type="checkbox" name="attr_has_string" value="1" >
      </fieldset>
    </div>
  </div>

  <!-- Group: Drive -->
  <!-- 
    Name and Origin Repeat (Booklet. Might leave out of digital sheet)
    Text input for drive
    TODO: Still being used?? --> 
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="summary-drive">Group: Drive</span>
    </div>
  </div>
    
  <!-- Abilities -->
  <!-- 
    Two text areas for abilities (Might more be needed)
    Depending on Archetype and with a checkbox in front of each ability to show they were activated
    (Maybe other form of highlighting picked/active abilities?)
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="abilities">Abilities</span>
    </div>
  </div>

  <!-- Actions -->
  <!-- 
    Four categories with 3,3,3 and 1 actions in each one each consists of:
    checkbox, name, kewords, field for own keyword(s)
    Last category changes from playbook to playbook

    Categories: Survival, Fury, Presence, Special Actions

    Actions: Survival > Craft, Hunt Traverse
             Fury     > Finesse, Force, Skirmish
             Presence > Banter, Threaten, Trick
             Special Actions > Tinker

    Actions can be skilled (checkbox)
    Each Action has 3-4 Keywords (knacks) listed which can be selected (underlined + bold)

    Unkilled actions Roll 1D, skill adds +1D any knacks that apply add another +1D
    more than one custom knack thinkable
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="actions">Actions</span>
    </div>
  </div>

  <!-- Wises -->
  <!-- 
    Twelve checkboxes with labels. The last one has a text field instead of a label
    (Are more than 1 custom wises likely?)

    Wises allow players to spend resolve to establish facts about the world.
    May need a roll and work like skills (1D, 2D)
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="wises">Wises</span>
    </div>
  </div>

  <!-- Heart & Endurance -->
  <!-- 
    Heart: Two checkboxes (probably used like a radio)
    Bloodied: Single Checkbox
    Endurance: Four checkboxes (probably used like a radio), expandable to 6
    Resolve: Four checkboxes (probably used like a radio), expandable to 6

    Heart works similar to Dark Hearts.
    Endurance & Resolve work a bit like stress but are rolled and can be upgraded
    from 4 to a maximum of 6 through XP advances.

    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="heart-endurance">Heart & Endurance</span>
    </div>
  </div>

  <!-- Struggles -->
  <!-- 
    Struggles: Checkbox and text field (What is the checkbox for?) for primary struggle.
    4 Text fields for other struggles (flexible number)

    Struggles will be divided into short- and long-term conditions that present a hinderance or
    challenge that either comes up once or is part of the character
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="struggles">Struggles</span>
    </div>
  </div>

  <!-- Advances -->
  <!-- 
    Seven Lines of Info on how to advance the character. (Need checking off?)
    Explanatory text
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="advances">Advances</span>
    </div>
  </div>

  <!-- Talisman -->
  <!-- 
    Contains: Image of talisman, selector name (dropdown), specific name,
    2 upgrade abilities with editable description,
    question about it with suggestions and space for answer (origin with text for answer)
    
    This is the center of most characters...  it's often some amazing item they have,
    but could also be an animal companion or even a magic power.
    Modular and selectable from presets on the PDF sheet.

    (Maybe allow highlighting of keywords with color or bold text)
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="talisman">Talisman</span>
    </div>
  </div>

  <!-- Gear Kits -->
  <!-- 
    Select two of three kits as well as a space with text for custom equipment

    Each PC will start with that basic gear kit there - backpack, bedroll, etc.
    They can then choose two others - small sets of items they have.
    These will have graphics and the PDF will make selecting these then printing it out easy,
    but they can also just be pasted onto the sheets / written in as well

    Multiple text lines for flexible other equipment
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="gear-kits">Gear Kits</span>
      <div class="kit-selector">
				<span>Base Kit :</span>
				<select name="attr_kit_base">
					<option value="none">None</option>
					<option value="builder">Builder</option>
					<option value="cook">Cook</option>
					<option value="explorer">Explorer</option>
					<option value="healer">Healer</option>
          <option value="hunter">Hunter</option>
					<option value="traveler" selected>Traveler</option>
					<option value="custom">Custom</option>
				</select>
        <!--
          <img src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Relic/img/kit-builder.png"/>
          <img src="https://raw.githubusercontent.com/eHanus/roll20-character-sheets/relic-creation/Relic/img/kit-traveler.png"/>
        -->
        <img name="attr_kit_base_url"/>
			</div>
      <div class="kit-selector">
				<span>Kit #1 :</span>
				<select name="attr_kit_1">
					<option value="none" selected>None</option>
					<option value="builder">Builder</option>
					<option value="cook">Cook</option>
					<option value="explorer">Explorer</option>
					<option value="healer">Healer</option>
          <option value="hunter">Hunter</option>
					<option value="traveler">Traveler</option>
					<option value="custom">Custom</option>
				</select>
        <img name="attr_kit_1_url"/>
			</div>
      <div class="kit-selector">
				<span>Kit #2 :</span>
				<select name="attr_kit_2">
					<option value="none" selected>None</option>
					<option value="builder">Builder</option>
					<option value="cook">Cook</option>
					<option value="explorer">Explorer</option>
					<option value="healer">Healer</option>
          <option value="hunter">Hunter</option>
					<option value="traveler">Traveler</option>
					<option value="custom">Custom</option>
				</select>
        <img name="attr_kit_2_url"/>
			</div>
    </div>
  </div>

  <!-- Story Arcs -->
  <!-- 
    Flexible Number of Lines with:
    Longterm-Box, Entry 1, Entry 2, Entry 3
  -->
    <div class="sheet-group">
      <div class="heading-box1">
        <span class="grouplabel" data-i18n="story-arcs">Story Arcs</span>
      </div>
    </div>


  <!-- Camp -->
  <!-- 
    Just information text?
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="camp">Camp</span>
    </div>
  </div>

  <!-- Season -->
  <!-- 
    Just information text?
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="season">Season</span>
    </div>
  </div>

  <!-- Arcs -->
  <!-- 
    Just information text?
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="arcs">Arcs</span>
    </div>
  </div>

  <!-- Advances -->
  <!-- 
    Just information text?
    -->
  <div class="sheet-group">
    <div class="heading-box1">
      <span class="grouplabel" data-i18n="advances">Advances</span>
    </div>
  </div>

</main>

<!--  ----------------------------------------------------------------------------------------------------------------------- -->
<!--  ------------------------------------------------- PARTY --------------------------------------------------------------- -->
<!--  ----------------------------------------------------------------------------------------------------------------------- -->
<main class="party">
  
  <div class="sheet-partytitle">

    <span> </span> <h2> Party </h2> <span> </span>
  
  </div>
  
  <div class="sheet-clues">
  
    <div class="sheet-clues-row">
        <span> </span>
    </div>

    <fieldset class="repeating_clues">
      <div class="sheet-clues-row">
        <span> </span>
        <textarea name="attr_cluedescription" value=""> </textarea>
        <span> </span>
      </div>
    </fieldset>
  </div>
  
  <div class="sheet-info sheet-flex-col">
    
  </div>

</main>

<!--  ----------------------------------------------------------------------------------------------------------------------- -->
<!--  ------------------------------------------------- GM ------------------------------------------------------------------ -->
<!--  ----------------------------------------------------------------------------------------------------------------------- -->


<main class="gamemaster">
  
  <div class="sheet-gmtitle">

    <span> </span> <h2> GM </h2> <span> </span>
  
  </div>
  
  <div class="sheet-clues">
  
    <div class="sheet-clues-row">
        <span> </span>
    </div>

    <fieldset class="repeating_clues">
      <div class="sheet-clues-row">
        <span> </span>
        <textarea name="attr_cluedescription" value=""> </textarea>
        <span> </span>
      </div>
    </fieldset>
  </div>
  
  <div class="sheet-info sheet-flex-col">
    
  </div>

</main>

<!--  ----------------------------------------------------------------------------------------------------------------------- -->
<!--  ------------------------------------------------- SETTINGS ------------------------------------------------------------ -->
<!--  ----------------------------------------------------------------------------------------------------------------------- -->


<main class="settings">
  
  <div class="sheet-gmtitle">

    <span> </span> <h2> SETTINGS </h2> <span> </span>
  
  </div>
  
  <div class="sheet-clues">
  
    <div class="sheet-clues-row">
        <span> </span>
    </div>

    <fieldset class="repeating_clues">
      <div class="sheet-clues-row">
        <span> </span>
        <textarea name="attr_cluedescription" value=""> </textarea>
        <span> </span>
      </div>
    </fieldset>
  </div>

  <div class="knack-names survival">
  
    <div class="survival-category-row">
        <span>Survival action & knack names</span>
        <input class="input" type="text" name="attr_category_survival_name" value="" title="Name for the Survival category" />
    </div>

    <div class="divTable">
      <div class="divTableBody">
        <div class="divTableRow">
          <div class="divTableCell">Action Name</div>
          <div class="divTableCell">Knack #1</div>
          <div class="divTableCell">Knack #2</div>
          <div class="divTableCell">Knack #3</div>
          <div class="divTableCell">Knack #4</div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_craft_name" title="Name for the Craft action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_craft_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_craft_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_craft_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_craft_4_name" title="Name for a knack" />
          </div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_hunt_name" title="Name for the Hunt action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_hunt_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_hunt_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_hunt_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_hunt_4_name" title="Name for a knack" />
          </div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_traverse_name" title="Name for the Traverse action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_traverse_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_traverse_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_traverse_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_traverse_4_name" title="Name for a knack" />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="knack-names fury">
  
    <div class="fury-category-row">
        <span>Fury action & knack names</span>
        <input class="input" type="text" name="attr_category_fury_name" value="" title="Name for the Fury category" />
    </div>

    <div class="divTable">
      <div class="divTableBody">
        <div class="divTableRow">
          <div class="divTableCell">Action Name</div>
          <div class="divTableCell">Knack #1</div>
          <div class="divTableCell">Knack #2</div>
          <div class="divTableCell">Knack #3</div>
          <div class="divTableCell">Knack #4</div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_finesse_name" title="Name for the Finesse action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_finesse_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_finesse_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_finesse_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_finesse_4_name" title="Name for a knack" />
          </div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_force_name" title="Name for the Force action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_force_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_force_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_force_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_force_4_name" title="Name for a knack" />
          </div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_skirmish_name" title="Name for the Skirmish action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_skirmish_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_skirmish_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_skirmish_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_skirmish_4_name" title="Name for a knack" />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="knack-names presence">
  
    <div class="presence-category-row">
        <span>Presence action & knack names</span>
        <input class="input" type="text" name="attr_category_presence_name" value="" title="Name for the Presence category" />
    </div>

    <div class="divTable">
      <div class="divTableBody">
        <div class="divTableRow">
          <div class="divTableCell">Action Name</div>
          <div class="divTableCell">Knack #1</div>
          <div class="divTableCell">Knack #2</div>
          <div class="divTableCell">Knack #3</div>
          <div class="divTableCell">Knack #4</div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_banter_name" title="Name for the Banter action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_banter_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_banter_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_banter_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_banter_4_name" title="Name for a knack" />
          </div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_threaten_name" title="Name for the Threaten action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_threaten_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_threaten_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_threaten_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_threaten_4_name" title="Name for a knack" />
          </div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_trick_name" title="Name for the Trick action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_trick_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_trick_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_trick_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_trick_4_name" title="Name for a knack" />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="knack-names special">
  
    <div class="special-category-row">
        <span>Special action & knack names</span>
        <input class="input" type="text" name="attr_category_special_name" value="" title="Name for the Special category" />
    </div>

    <div class="divTable">
      <div class="divTableBody">
        <div class="divTableRow">
          <div class="divTableCell">Action Name</div>
          <div class="divTableCell">Knack #1</div>
          <div class="divTableCell">Knack #2</div>
          <div class="divTableCell">Knack #3</div>
          <div class="divTableCell">Knack #4</div>
        </div>
        <div class="divTableRow">
          <div class="divTableCell">
            <input class="input" type="text" name="attr_action_tinker_name" title="Name for the Tinker action" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_tinker_1_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_tinker_2_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_tinker_3_name" title="Name for a knack" />
          </div>
          <div class="divTableCell">
            <input class="input" type="text" name="attr_knack_tinker_4_name" title="Name for a knack" />
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="kit-urls">
  
    <div class="kit-urls-row">
        <span>Base kit custom URL</span>
    </div>

    <fieldset class="kit_base_url">
      <div class="kit-urls-row">
        <span> </span>
        <input class="input" type="text" name="attr_kit_base_custom_url" value="" title="Base kit URL" />
        <span> </span>
      </div>
    </fieldset>

    <div class="kit-urls-row">
      <span>Kit #1 custom URL</span>
    </div>

    <fieldset class="kit_1_url">
      <div class="kit-urls-row">
        <span> </span>
        <input class="input" type="text" name="attr_kit_1_custom_url" value="" title="Kit #1 URL" />
        <span> </span>
      </div>
    </fieldset>

    <div class="kit-urls-row">
      <span>Kit #2 custom URL</span>
    </div>

    <fieldset class="kit_2_url">
      <div class="kit-urls-row">
        <span> </span>
        <input class="input" type="text" name="attr_kit_2_custom_url" value="" title="Kit #2 URL" />
        <span> </span>
      </div>
    </fieldset>

  </div>
  
  <div class="sheet-info sheet-flex-col">
    
  </div>

</main>


<!--  ----------------------------------------------------------------------------------------------------------------------- -->
<!--  ------------------------------------------------- ROLL TEMPLATES ------------------------------------------------------ -->
<!--  ----------------------------------------------------------------------------------------------------------------------- -->


<!--  ----------------------------------------------------------------------------------------------------------------------- -->
<!--  ------------------------------------------------- SHEET WORKERS ------------------------------------------------------- -->
<!--  ----------------------------------------------------------------------------------------------------------------------- -->

<script type="text/worker">
// type="text/worker"

const imageDirectory = "https://raw.githubusercontent.com/eHanus/roll20-character-sheets/relic-creation/Relic/img/";

// tabs
const buttonlist = ["character", "party","gamemaster","settings"];
buttonlist.forEach(button => {
    on(`clicked:${button}`, function() {

        setAttrs({
            sheetTab: button
        });
    });
});

on("sheet:opened", function() {

  getAttrs(["sheetTab"], values => {

    let sheetTab = values["sheetTab"];
    console.log("sheetTab: ", sheetTab);

    if (sheetTab === "character"){
      console.log("sheetTab was char", npc);
    }
    else if (sheetTab === "party"){
      console.log("sheetTab was party", npc);
    }
    else if (sheetTab === "gamemaster"){
      console.log("sheetTab was gamemaster");
    }
    else if (sheetTab === "settings"){
      console.log("sheetTab was settings");
    }
  });
});


// Auto-populate localized actions and knacks

on("sheet:opened", function() {
  getAttrs(["action_craft_name","action_hunt_name","action_traverse_name",
			"action_finesse_name","action_force_name","action_skirmish_name",
			"action_banter_name","action_threaten_name","action_trick_name","action_tinker_name"], function(v){
    set = {};
	// Survival block
    if (v["action_craft_name"] === " " || v["action_craft_name"] === ""){
		set["action_craft_name"] = getTranslationByKey("action_craft");
		set["knack_craft_1_name"] = getTranslationByKey("knack_food");
		set["knack_craft_2_name"] = getTranslationByKey("knack_herbalism");
		set["knack_craft_3_name"] = getTranslationByKey("knack_goods");
		set["knack_craft_4_name"] = getTranslationByKey("knack_traps");
	}
	if (v["action_hunt_name"] === " " || v["action_hunt_name"] === ""){
		set["action_hunt_name"] = getTranslationByKey("action_hunt");
		set["knack_hunt_1_name"] = getTranslationByKey("knack_shoot");
		set["knack_hunt_2_name"] = getTranslationByKey("knack_sneak");
		set["knack_hunt_3_name"] = getTranslationByKey("knack_track");
		set["knack_hunt_4_name"] = "";
	}
	if (v["action_traverse_name"] === " " || v["action_traverse_name"] === ""){
		set["action_traverse_name"] = getTranslationByKey("action_traverse");
		set["knack_traverse_1_name"] = getTranslationByKey("knack_climb");
		set["knack_traverse_2_name"] = getTranslationByKey("knack_run");
		set["knack_traverse_3_name"] = getTranslationByKey("knack_scramble");
		set["knack_traverse_4_name"] = getTranslationByKey("knack_swim");
	}
	// Fury block
	if (v["action_finesse_name"] === " " || v["action_finesse_name"] === ""){
		set["action_finesse_name"] = getTranslationByKey("action_finesse");
		set["knack_finesse_1_name"] = getTranslationByKey("knack_evade");
		set["knack_finesse_2_name"] = getTranslationByKey("knack_handle_objects");
		set["knack_finesse_3_name"] = getTranslationByKey("knack_solve_puzzles");
		set["knack_finesse_4_name"] = "";
	}
	if (v["action_force_name"] === " " || v["action_force_name"] === ""){
		set["action_force_name"] = getTranslationByKey("action_force");
		set["knack_force_1_name"] = getTranslationByKey("knack_leverage");
		set["knack_force_2_name"] = getTranslationByKey("knack_position");
		set["knack_force_3_name"] = getTranslationByKey("knack_wreck");
		set["knack_force_4_name"] = "";
	}
	if (v["action_skirmish_name"] === " " || v["action_skirmish_name"] === ""){
		set["action_skirmish_name"] = getTranslationByKey("action_skirmish");
		set["knack_skirmish_1_name"] = getTranslationByKey("knack_defend");
		set["knack_skirmish_2_name"] = getTranslationByKey("knack_kill");
		set["knack_skirmish_3_name"] = getTranslationByKey("knack_subdue");
		set["knack_skirmish_4_name"] = "";
	}
	// Presence block
	if (v["action_banter_name"] === " " || v["action_banter_name"] === ""){
		set["action_banter_name"] = getTranslationByKey("action_banter");
		set["knack_banter_1_name"] = getTranslationByKey("knack_impress");
		set["knack_banter_2_name"] = getTranslationByKey("knack_make_friends");
		set["knack_banter_3_name"] = getTranslationByKey("knack_negotiate");
		set["knack_banter_4_name"] = "";
	}
	if (v["action_threaten_name"] === " " || v["action_threaten_name"] === ""){
		set["action_threaten_name"] = getTranslationByKey("action_threaten");
		set["knack_threaten_1_name"] = getTranslationByKey("knack_command");
		set["knack_threaten_2_name"] = getTranslationByKey("knack_frighten");
		set["knack_threaten_3_name"] = getTranslationByKey("knack_interrogate");
		set["knack_threaten_4_name"] = "";
	}
	if (v["action_trick_name"] === " " || v["action_trick_name"] === ""){
		set["action_trick_name"] = getTranslationByKey("action_trick");
		set["knack_trick_1_name"] = getTranslationByKey("knack_disguise");
		set["knack_trick_2_name"] = getTranslationByKey("knack_lie");
		set["knack_trick_3_name"] = getTranslationByKey("knack_outwit");
		set["knack_trick_4_name"] = "";
	}
	// Special block
	if (v["action_tinker_name"] === " " || v["action_tinker_name"] === ""){
		set["action_tinker_name"] = getTranslationByKey("action_tinker");
		set["knack_special_1_name"] = getTranslationByKey("knack_create");
		set["knack_special_2_name"] = getTranslationByKey("knack_repair");
		set["knack_special_3_name"] = getTranslationByKey("knack_use");
		set["knack_special_4_name"] = "";
	}
    setAttrs(set, {silent: true});
  });
});


// Kit graphics

on("change:kit_base", function() {
   getAttrs(["kit_base", "kit_base_custom_url"], function(values) {
      //Do something with values.kit_base
      let newURL = "";
      switch (values.kit_base) {
        case "none":
          break;
        case "custom":
          newURL = values.kit_base_custom_url;
          break;
        default:
          newURL = imageDirectory + "kit-" + values.kit_base + ".png";
          break;
      }
      setAttrs({                            
        "kit_base_url": newURL
      });
   });
});

on("change:kit_1", function() {
   getAttrs(["kit_1", "kit_1_custom_url"], function(values) {
      //Do something with values.kit_base
      let newURL = "";
      switch (values.kit_1) {
        case "none":
          break;
        case "custom":
          newURL = values.kit_1_custom_url;
          break;
        default:
          newURL = imageDirectory + "kit-" + values.kit_1 + ".png";
          break;
      }
      setAttrs({                            
        "kit_1_url": newURL
      });
   });
});

on("change:kit_2", function() {
   getAttrs(["kit_2", "kit_2_custom_url"], function(values) {
      //Do something with values.kit_base
      let newURL = "";
      switch (values.kit_2) {
        case "none":
          break;
        case "custom":
          newURL = values.kit_2_custom_url;
          break;
        default:
          newURL = imageDirectory + "kit-" + values.kit_2 + ".png";
          break;
      }
      setAttrs({                            
        "kit_2_url": newURL
      });
   });
});

</script>
